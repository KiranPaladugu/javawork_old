package com.marconi.tmp.tools;

import java.util.ArrayList;
import java.util.List;

import com.marconi.fusion.X36.X36NeId;
import com.marconi.fusion.tmf.i36PlugIn.realignment.BeginRealignmentEvent;
import com.marconi.fusion.tmf.i36PlugIn.realignment.EndRealignmentEvent;
import com.marconi.fusion.tmf.plugIn.types.MEDn;

public class BERConversiontEventSupport {
	List<BERConversionEventListener> listeners = new ArrayList<BERConversionEventListener>();
	Object source = null;
	
	public BERConversiontEventSupport(Object source) {
		this.source = source;
	}
	
	public void clearListener() {
		synchronized (listeners) {
			listeners.clear();
		}
	}

	public void addListener(BERConversionEventListener lst) {
		synchronized (listeners) {
			listeners.add(lst);
		}
	}
	
	public void removeListener(BERConversionEventListener lst) {
		synchronized (listeners) {
			listeners.remove(lst);
		}
	}

	public void fireEvent(BERConversionEvent event) { 
		List<BERConversionEventListener> backup = null;
		synchronized (listeners) {
			backup = new ArrayList<BERConversionEventListener>(listeners);
		}
		for (BERConversionEventListener lst : backup)
			lst.onRealignmentEvent(event);
	}

	public void fireBeginRealignmentEvent(MEDn meDn, X36NeId neId) {
		BeginRealignmentEvent event = new BeginRealignmentEvent(source, meDn, neId);
		fireEvent(event);
	}

	public void fireEndRealignmentEvent(MEDn meDn, X36NeId neId, boolean completed) {
		EndRealignmentEvent event = new EndRealignmentEvent(source, meDn, neId, completed);
		fireEvent(event);
	}
	
	public void fireEndRealignmentEvent(MEDn meDn, X36NeId neId, boolean completed, String cause) {
		EndRealignmentEvent event = new EndRealignmentEvent(source, meDn, neId, completed, cause);
		fireEvent(event);
	}
}
